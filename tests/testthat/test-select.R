context("'select' on CrunchDataset")

with_mock_crunch({
    ds <- loadDataset("test ds")
    test_that("Some facts about the fixture dataset", {
        expect_identical(names(ds),
            c("birthyr", "gender", "mymrset", "textVar", "starttime", "catarray"))
    })

    test_that("Basic 'select' equivalence", {
        expect_identical(select(ds, starttime, birthyr, gender),
            ds[c("starttime", "birthyr", "gender")])
        expect_identical(select(ds, starts_with("m")),
            ds["mymrset"])
        expect_identical(select(ds, gender:textVar),
            ds[c("gender", "mymrset", "textVar")])
    })
})
